{{config(
  materialized='view',
  schema='silver'
)}}

WITH raw AS(
  SELECT *
  FROM 
    {{source('silver','raw_cleaned_h241_medical_conditions_ccsr')}}
)

SELECT 
    DUPERSID AS patient_id,
    total_condition_count,
    hashypertension,
    hashypothyroidism,
    hasmuscleweakness,
    hasthyroiddisorder,
    hasptsd,
    hasurinarytractinfection,
    hasanxietydisorder,
    hasfacialtumor,
    hasosteoporosis,
    hasdiabetes,
    hassleepapnea,
    haspepticulcer,
    hasparkinsondisease,
    hasspinalinjury,
    hasbonefracture,
    hasskinulcer,
    haspoison,
    hasshortofbreath,
    haseatingdisorder,
    hasbursitis,
    hasheartfailure,
    hasconstipation,
    hasurethritis,
    hasglaucoma,
    hastoothdecay,
    hasneuropathy,
    hasweightgain,
    hasmetabolicdisorder,
    hasangina,
    hasasthma,
    hasfacialcyst,
    haspleuraleffusion,
    hasskininfection,
    hasdislocation,
    hascolitis,
    hascough,
    hashearingloss,
    hasfacialinfection,
    hasparasiticinfection,
    hasabdominalpain,
    hascataract,
    hasadhd,
    hasdiarrhea,
    hasfacialburn,
    haslymphoma,
    hasarthritis,
    hasviralinfection,
    hasjointinflammation,
    hashypotension,
    haslungdisease,
    hasmultipletrauma,
    hasblindness,
    hasmaculardegeneration,
    hasfacialtrauma,
    hasinjury,
    hasfacialinflammation,
    hashyperthyroidism,
    haspancreaticcancer,
    hasfacialdeformity,
    hasdigestivedisorder,
    hascancer,
    hasdementia,
    hasmentalhealthdisorder,
    hasjointpain,
    haspneumonia,
    hasgynelogicaldisorder,
    hastinnitus,
    hasspinalcordinjury,
    hasalzheimers,
    hasnausea,
    hasearinfection,
    hasgallbladderdisease,
    hasmusclecramp,
    hasbackpain,
    hasweightloss,
    hascarpaltunnel,
    hasfacialpain,
    hasdermatitis,
    hasdiabeticretinopathy,
    hascirculatorydisorder,
    haschestpain,
    haspulmonaryfibrosis,
    hasmusculoskeletaldisorder,
    hasfacialdisorder,
    haseyeinflammation,
    hasbacterialinfection,
    hasstroke,
    haspregnancyhypertension,
    haspersonalitydisorder,
    hascopd,
    hashypoglycemia,
    haskidneystone,
    hasinfectiousdisease,
    hasgenitourinarydisorder,
    hasrespiratoryfailure,
    hasskincancer,
    hasbipolardisorder,
    hasmultiplesclerosis,
    hasrenalfailure,
    hasheadache
FROM 
    raw 